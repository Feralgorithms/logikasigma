<div class="h-16"></div>

<!-- Hero Article Section -->
<section class="relative w-full h-96 mb-12">
  <img src="<%= article.cover_image %>" alt="<%= article.title %>" class="w-full h-full object-cover">

  <div
    class="absolute inset-0 bg-gradient-to-b from-black/50 to-black/70 flex flex-col items-center justify-center text-center px-4">
    <h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold text-center mb-8 
             bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 
             text-transparent bg-clip-text drop-shadow-lg opacity-0 animate-fadeIn">
      <%= article.title %>
    </h1>

    <div class="flex flex-wrap items-center justify-center text-white/90 mt-6 gap-6 opacity-0 animate-fadeIn delay-200">
      <span class="flex items-center gap-2">
        <i class="far fa-calendar-alt"></i>
        <%= new Date(article.published_at).toLocaleDateString("id-ID") %>
      </span>
      <span class="flex items-center gap-2">
        <i class="far fa-user"></i>
        <%= article.users ? article.users.name : "Admin" %>
      </span>
      <span class="flex items-center gap-2">
        <i class="far fa-clock"></i>
        5 menit baca
      </span>
    </div>

    <% if (article.article_tags && article.article_tags.length> 0) { %>
      <div class="flex flex-wrap gap-2 mt-6 opacity-0 animate-fadeIn delay-400 justify-center">
        <% article.article_tags.forEach(t=> { %>
          <a href="/tag/<%= t.tags.slug %>"
            class="px-4 py-1.5 bg-white/20 backdrop-blur-sm rounded-full text-xs font-medium text-white hover:bg-white/30 transition-all duration-300">
            #<%= t.tags.name %>
          </a>
          <% }) %>
      </div>
      <% } %>
  </div>
</section>

<div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12 max-w-7xl">
  <!-- Main Layout -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">

    <!-- Main Content -->
    <div class="lg:col-span-2">
      <article class="prose prose-lg max-w-none 
                      prose-headings:font-bold prose-headings:text-gray-800 
                      prose-p:text-gray-700 prose-a:text-purple-600 
                      prose-a:no-underline hover:prose-a:text-pink-500
                      prose-img:rounded-2xl">

        <% if (article.content && article.content.blocks) { %>
          <% article.content.blocks.forEach(block=> { %>

            <!-- Header -->
            <% if (block.type==="header" ) { %>
              <h<%= block.data.level %> class="mt-10 mb-6 text-2xl bg-gradient-to-r from-purple-500 via-pink-500
                to-orange-500
                bg-clip-text text-transparent font-extrabold tracking-tight leading-tight">
                <%= block.data.text %>
              </h<%= block.data.level %>>

              <!-- Paragraph -->
              <% } else if (block.type==="paragraph" ) { %>
                <p class="leading-relaxed text-xl mb-6 font-light tracking-wide text-justify">
                  <%- block.data.text %>
                </p>

                <!-- Image -->
                <% } else if (block.type==="image" ) { %>
                  <figure class="my-10">
                    <div class="overflow-hidden rounded-2xl shadow-xl border border-gray-100">
                      <img src="<%= block.data.file.url %>" alt="<%= block.data.caption || '' %>"
                        class="w-full object-cover hover:scale-105 transition-transform duration-700">
                    </div>
                    <% if (block.data.caption) { %>
                      <figcaption class="mt-3 text-center text-gray-500 text-sm italic font-light">
                        <%= block.data.caption %>
                      </figcaption>
                      <% } %>
                  </figure>

                  <!-- Code -->
                  <% } else if (block.type==="code" ) { %>
                    <div class="relative my-8 group">
                      <pre
                        class="bg-gray-900 text-green-300 p-6 rounded-xl shadow-lg overflow-x-auto text-sm font-mono border border-gray-700"><code class="whitespace-pre-wrap"><%- block.data.code %></code></pre>
                      <button type="button" class="copy-code-btn absolute top-3 right-3 bg-gray-700 hover:bg-gray-600 
                               text-white text-xs px-3 py-1.5 rounded-lg font-medium transition-all duration-300 
                               opacity-0 group-hover:opacity-100">
                        Copy
                      </button>
                    </div>

                    <!-- List -->
                    <% } else if (block.type==="list" ) { %>
                      <ul
                        class="list-disc list-inside space-y-3 mb-8 marker:text-purple-500 font-light text-xl tracking-wide">
                        <% block.data.items.forEach(item=> { %>
                          <li class="pl-2"><%- item %></li>
                          <% }) %>
                      </ul>
                      <% } %>

                        <% }) %>
                          <% } %>

      </article>
    </div>

    <!-- Sidebar -->
    <aside class="space-y-6 lg:sticky lg:top-20 lg:self-start">

      <!-- Search Box -->
      <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
        <h3 class="text-xl font-bold mb-4 text-gray-800 flex items-center gap-2">
          <i class="fas fa-search text-purple-500"></i>
          Cari Artikel
        </h3>
        <form action="/search" method="GET" class="space-y-3">
          <input type="text" name="q" placeholder="Cari artikel..."
            class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent focus:outline-none transition-all">
          <button type="submit"
            class="w-full px-4 py-3 bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 text-white font-semibold rounded-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5">
            Cari
          </button>
        </form>
      </div>

      <!-- Kategori -->
      <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
        <h3 class="text-xl font-bold mb-4 text-gray-800 flex items-center gap-2">
          <i class="fas fa-folder text-purple-500"></i>
          Kategori
        </h3>
        <div class="flex flex-wrap gap-2">
          <% if (categorys && categorys.length> 0) { %>
            <% categorys.forEach(category=> { %>
              <a href="/category/<%= category.slug %>"
                class="px-4 py-2 bg-gray-50 border border-gray-200 rounded-full text-gray-700 text-sm font-medium 
                        hover:bg-gradient-to-r hover:from-purple-500 hover:via-pink-500 hover:to-orange-500 
                        hover:text-white hover:border-transparent transition-all duration-300 shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                <%= category.name %>
              </a>
              <% }) %>
                <% } else { %>
                  <p class="text-gray-500 text-sm">Belum ada kategori tersedia.</p>
                  <% } %>
        </div>
      </div>

      <!-- Tags -->
      <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
        <h3 class="text-xl font-bold mb-4 text-gray-800 flex items-center gap-2">
          <i class="fas fa-tags text-purple-500"></i>
          Tags
        </h3>
        <div class="flex flex-wrap gap-2">
          <% if (tags && tags.length> 0) { %>
            <% tags.forEach(tag=> { %>
              <a href="/tags/<%= tag.slug %>"
                class="px-4 py-2 bg-gray-50 border border-gray-200 rounded-full text-gray-700 text-sm font-medium 
                        hover:bg-gradient-to-r hover:from-purple-500 hover:via-pink-500 hover:to-orange-500 
                        hover:text-white hover:border-transparent transition-all duration-300 shadow-sm hover:shadow-md transform hover:-translate-y-0.5">
                #<%= tag.name %>
              </a>
              <% }) %>
                <% } else { %>
                  <p class="text-gray-500 text-sm">Belum ada tag tersedia.</p>
                  <% } %>
        </div>
      </div>

      <!-- Artikel Terbaru -->
      <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
        <h3 class="text-xl font-bold mb-4 text-gray-800 flex items-center gap-2">
          <i class="fas fa-fire text-purple-500"></i>
          Artikel Terbaru
        </h3>
        <ul class="space-y-4">
          <% latest.forEach(lat=> { %>
            <li class="group">
              <a href="/article/<%= lat.slug %>"
                class="flex items-start gap-3 hover:bg-gray-50 p-2 rounded-lg transition-all duration-300">
                <img src="<%= lat.cover_image %>" alt="<%= lat.title %>"
                  class="w-16 h-16 object-cover rounded-lg shadow-sm group-hover:shadow-md transition-shadow">
                <span
                  class="flex-1 text-sm font-medium text-gray-700 group-hover:text-purple-600 transition-colors line-clamp-2">
                  <%= lat.title %>
                </span>
              </a>
            </li>
            <% }) %>
        </ul>
      </div>
    </aside>
  </div>


</div>